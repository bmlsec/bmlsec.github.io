---
layout: post
title: Bandit from OverTheWire
categories: [Bandit, OverTheWire, SSH, Linux, netcat, terminal]
---

![OverTheWire](/images/bandit/overthewire_logo_border.png)

I was checking this [podcast](https://www.youtube.com/watch?v=ob7-nTpBgjQ) from [John Hammond](https://twitter.com/_johnhammond), where he talks about several things, including advice to beginners, and he mentioned [OverTheWire](https://overthewire.org/wargames/) Bandit series, something I haven't heard about... so I went to their web page and started playing around... it was really fun and I've learned plenty of new stuff.

Now it's time to share with you my experience, a complete walkthrough of all 33 levels that exist up to date. Enjoy!

Bare in mind that this is for <span style="text-decoration: underline">absolute beginners</span>, if you have experience in Linux, it could be annoying to you... but read it anyway, there's always something unexpected to learn.

The objective of this [game](https://overthewire.org/wargames/bandit/) is: always get the credentials to login into the next level, and learn something new along the way.

**Before** you begin, you need to learn a little bit of [basic Linux commands](https://maker.pro/linux/tutorial/basic-linux-commands-for-beginners), because the terminal is the only thing you need to solve all levels. 

## Level 0

> **Level Goal**
> 
 *The goal of this level is for you to log into the game using SSH. The host to which you need to connect is bandit.labs.overthewire.org, on port 2220. The username is bandit0 and the password is bandit0. Once logged in, go to the Level 1 page to find out how to beat Level 1.*

So, type `man ssh` in the terminal and learn how to use [SSH](https://www.ssh.com/ssh/), in the end, you can try to connect to the server, using `[user]@[server] -p [port]` syntax:
```
bml@ubuntu:~/overthewire/bandit$ ssh bandit0@bandit.labs.overthewire.org -p 2220
The authenticity of host '[bandit.labs.overthewire.org]:2220 ([176.9.9.172]:2220)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[bandit.labs.overthewire.org]:2220,[176.9.9.172]:2220' (ECDSA) to the list of known hosts.
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit0@bandit.labs.overthewire.org's password:
```

you will get the message for the ECDSA key fingerprint, just type '*yes*' and then type the password (it's in the [level page](https://overthewire.org/wargames/bandit/bandit0.html)).

you are now connected to the server via SSH, your terminal should be something like `bandit0@bandit:~$`

go to the next [level](https://overthewire.org/wargames/bandit/bandit1.html).

## Level 0 → Level 1

> **Level Goal**
>
*The password for the next level is stored in a file called readme located in the home directory. Use this password to log into bandit1 using SSH. Whenever you find a password for a level, use SSH (on port 2220) to log into that level and continue the game.*

You are connected to the server via SSH and now you have to type some basic Linux commands to find the password for the next level... from the level goal, you already know that the password is stored in a *readme* file in the home directory.

```
bandit0@bandit:~$ ls
readme                                                                                                      
bandit0@bandit:~$ cat readme                                                                                
boJ9jbbUNNfktd78OOpsqOltutMc3MY1
```
quit the SSH session and save the password in your local computer:
```
bandit0@bandit:~$ exit                                                                                      
logout                                                                                                      
Connection to bandit.labs.overthewire.org closed.                                                           
bml@ubuntu:~/overthewire/bandit$ mkdir level0
bml@ubuntu:~/overthewire/bandit$ cd level0/                                                       
bml@ubuntu:~/overthewire/bandit/level0$ echo boJ9jbbUNNfktd78OOpsqOltutMc3MY1 > pass.txt          
bml@ubuntu:~/overthewire/bandit/level0$ cat pass.txt                                              
boJ9jbbUNNfktd78OOpsqOltutMc3MY1
```
now that you have all organized and the password saved for future use, go for the next [level](https://overthewire.org/wargames/bandit/bandit2.html).

## Level 1 → Level 2

> **Level Goal**
>
*The password for the next level is stored in a file called - located in the home directory*

First login to the server using the password that you have from the previous level
```
bml@ubuntu:~/overthewire/bandit$ ssh bandit1@bandit.labs.overthewire.org -p 2220           
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames                  
                                                                                       s                     
bandit1@bandit.labs.overthewire.org's password: 
[...]
bandit1@bandit:~$ ls
-
bandit1@bandit:~$ 
```
now that you have listed the files in the home folder, you have to find a way to print the contents of the file, and if you try `cat -`... nothing happens... because `-` in Linux means `stdin` (standard input). Just press Ctrl+c to cancel the command.

Files beginning with a dash have to be treated differently because the dash is used to indicate input parameters for commands.

The way you have to `cat` files beginning with `-` in Linux is like this:
```
bandit1@bandit:~$ cat ./-
CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9
```
the dot-slash, ./, is a relative path to something in the current directory.
The dot is the current directory and the slash is a path delimiter.

Alternatively, you can use a redirection:
```
bandit1@bandit:~$ cat <-
CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9
```
which is just sending the file `-` as input for the `cat` command.

Now you have the password for the next level and also a little bit more knowledge of Linux commands.

## Level 2 → Level 3

> **Level Goal**
>
*The password for the next level is stored in a file called spaces in this filename located in the home directory*

After login to the server, you can `ls` and see that the file located in the home directory is `spaces in this filename`:

```
bandit2@bandit:~$ ls
spaces in this filename
```

if you try `cat` then typing the file name, you'll get an error:

```
bandit2@bandit:~$ cat spaces in this filename
cat: spaces: No such file or directory
cat: in: No such file or directory
cat: this: No such file or directory
cat: filename: No such file or directory
```

why? because `cat` *thinks* you are trying to display the contents of several files. The spaces in the file name are interpreted as delimiters for different file names, the command is trying to display the contents of 4 files (*spaces*, *in*, *this* and *filename*). 

To understand this a little bit more, make a new folder in /tmp/ and try this:
```
bandit2@bandit:~$ mkdir /tmp/testingfiles
bandit2@bandit:~$ cd /tmp/testingfiles
bandit2@bandit:/tmp/testingfiles$ echo "Red" > color1
bandit2@bandit:/tmp/testingfiles$ echo "Green" > color2
bandit2@bandit:/tmp/testingfiles$ echo "White" > color3
bandit2@bandit:/tmp/testingfiles$ ls
color1  color2  color3
```
so, you created 3 files, now you can display its contents all at once with `cat file1 file2 file3`
```
bandit2@bandit:/tmp/testingfiles$ cat color1 color2 color3
Red
Green
White
```
and how to indicate that the spaces are part of the file name and not actual spaces? use a backslash, it is an [escape character in the shell syntax](https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_02_01).
```
bandit2@bandit:~$ cat spaces\ in\ this\ filename 
UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK

```
Extra tip: type `cat spa` and then press TAB on your keyboard, it will complete the file name for you.

## Level 3 → Level 4

> **Level Goal**
>
*The password for the next level is stored in a hidden file in the inhere directory.*

From now on, I will assume that you are already logged in the server via SSH with the password from the previous level.

In this level you are required to list a hidden file, so look at the help or man page for `ls` and verify how can you do it.

```
bandit3@bandit:~$ ls
inhere
bandit3@bandit:~$ cd inhere/
bandit3@bandit:~/inhere$ ls
bandit3@bandit:~/inhere$ ls -la
total 12
drwxr-xr-x 2 root    root    4096 Oct 16  2018 .
drwxr-xr-x 3 root    root    4096 Oct 16  2018 ..
-rw-r----- 1 bandit4 bandit3   33 Oct 16  2018 .hidden
bandit3@bandit:~/inhere$ cat .hidden
pIwrPrtPN36QITSp3EQaw936yaFoFgAB
```

All files beginning with a dot are hidden files. Same for folders.

## Level 4 → Level 5

> **Level Goal**
>
*The password for the next level is stored in the only human-readable file in the inhere directory. Tip: if your terminal is messed up, try the “reset” command.*

```
bandit4@bandit:~$ ls
inhere
bandit4@bandit:~$ cd inhere/
bandit4@bandit:~/inhere$ ls
-file00  -file01  -file02  -file03  -file04  -file05  -file06  -file07  -file08  -file09
```

You have 10 files and the one *human-readable* has the password...

In Linux, as in many other things in life, there are plenty of different ways to do the same thing... you can google the use of different methods, I will focus on the `file` command.

Normally you can list all the files in the folder with `file *`
```
bandit4@bandit:~/inhere$ file *
file: Cannot open `ile00' (No such file or directory).
file: Cannot open `ile01' (No such file or directory).
file: Cannot open `ile02' (No such file or directory).
file: Cannot open `ile03' (No such file or directory).
file: Cannot open `ile04' (No such file or directory).
file: Cannot open `ile05' (No such file or directory).
file: Cannot open `ile06' (No such file or directory).
file: Cannot open `ile07' (No such file or directory).
file: Cannot open `ile08' (No such file or directory).
file: Cannot open `ile09' (No such file or directory).
```
but, as you already know, if the file name starts with a dash... 
what's happening here is that `file` is interpreting the command for the first file as `file -file00` so, a `-f` parameter with the value `ile00`, that's why we get the `Cannot open 'ile00'` error.

You can type `file ./*`, meaning *run file command on all(\*) files in the current folder*.
The file name along with the file type will be printed to standard output:
```
bandit4@bandit:~/inhere$ file ./*
./-file00: data
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text
./-file08: data
./-file09: data
```

now you know that the password is in -file07, get it.
```
bandit4@bandit:~/inhere$ cat < -file07
koReBOKuIDDepwhWk7jZC0RTdopnAYKh
```

Final notes: there are plenty of ways to solve this level, you can go and try each file one by one, or try different commands, like this ones:
```
bandit4@bandit:~/inhere$ file -- *
bandit4@bandit:~/inhere$ cat ./*
bandit4@bandit:~/inhere$ for f in $(ls); do file ./$f; done
bandit4@bandit:~/inhere$ for f in $(ls); do cat ./$f; done
bandit4@bandit:~/inhere$ find . -type f -exec file {} \; | grep "ASCII"
```
and try to understand all of them.

## Level 5 → Level 6

> **Level Goal**
>
*The password for the next level is stored in a file somewhere under the inhere directory and has all of the following properties:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;human-readable  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1033 bytes in size  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not executable*

if you `ls` the *inhere* folder, you find that you have another 20 folders inside... to find out how many files there is in all of them, just use the `find` command, like this:
```
bandit5@bandit:~$ find inhere -type f | wc -l
180
```
to clarify the command, we are telling Linux to find in the *inhere* folder, all files of type file (yes, folders in Linux are also files, but with type "d" instead of "f"...), and then pipe the results to `wc -l` command, that will tell us how many files exist in the folder.

180 files in total, too much to go one by one... it's time to see the man page for `find` and try to match the conditions for the level goal.

1. *human-readable*
```
bandit5@bandit:~$ find inhere -type f -exec file {} \; | grep "ASCII" | wc -l
118
```
118 files that returned "ASCII" in the result of the `file` command

2. *1033 bytes in size*
```
bandit5@bandit:~$ find inhere -size 1033c | wc -l
1
```
that should be the one... but let's see the last condition

3. *not executable*
```
bandit5@bandit:~$ find inhere -type f ! -executable | wc -l
60
```
60 files... ok, we could have found the password with just one criteria (size), but here is the command  to join all 3:
```
bandit5@bandit:~$ find inhere -type f ! -executable -size 1033c -exec file {} \; | grep "ASCII"
inhere/maybehere07/.file2: ASCII text, with very long lines
bandit5@bandit:~$ cat inhere/maybehere07/.file2
DXjZPULLxYr17uwoI01bNLQbtFemEgo7
```

## Level 6 → Level 7

> **Level Goal**
>
*The password for the next level is stored somewhere on the server and has all of the following properties:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owned by user bandit7  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owned by group bandit6  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33 bytes in size*

This time there isn't a specif folder to look in, we have to look in the entire server... the way we do that, is to state the base folder of the system (`/`) in our search. And similar to the last level, you have to dig a little bit on the man page for the `find` command.
```
bandit6@bandit:/tmp/slb4ever$ find / -type f -user bandit7 -group bandit6 -size 33c
```
This will do the trick, but you will have several `Permission denied` messages... how to find the file in all those lines? simple, just redirect all error messages to `/dev/null` which is the null device, it takes any input you want and throws it away. It can be used to suppress any output. 
```
bandit6@bandit:~$ find / -type f -user bandit7 -group bandit6 -size 33c 2>/dev/null
/var/lib/dpkg/info/bandit7.password
bandit6@bandit:~$ cat /var/lib/dpkg/info/bandit7.password
HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs
```

## Level 7 → Level 8

> **Level Goal**
>
*The password for the next level is stored in the file data.txt next to the word millionth*

In this level you have to explore the man page for `grep` command, which allows you to search for specific patterns inside files.

Grep, by default, shows the content of the line that matches the search argument.
In these next two examples you are searching for *millionth* inside the file *data.txt* and `grep` will display the corresponding line.
```
bandit7@bandit:~$ grep millionth data.txt 
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
- or -
bandit7@bandit:~$ cat data.txt | grep millionth
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
```

## Level 8 → Level 9

> **Level Goal**
>
*The password for the next level is stored in the file data.txt and is the only line of text that occurs only once*

This level requires you to understand how `uniq` and `sort` commands work, go and read the man pages.

To find a unique line you can use the `uniq` command, but it will filter only adjacent matching lines, so if you have duplicates that are not adjacent to each other, they are not considered unique. So we need a way to re-arrange the file *data.txt* in order to have sorted lines, that way all duplicates will be sequential.

You can do that with the `sort` command. Note that you cannot use `sort -u`, because that will delete all duplicates. You need to preserve the duplicates to find out which one is really unique.

So, you need to use `sort` on the file, then send the results to `uniq -u`, here are two examples:
```
bandit8@bandit:~$ sort data.txt | uniq -u
UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR
- or -
bandit8@bandit:~$ cat data.txt | sort | uniq -u
UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR
```

## Level 9 → Level 10

> **Level Goal**
>
*The password for the next level is stored in the file data.txt in one of the few human-readable strings, beginning with several ‘=’ characters*

Now we have a data file instead of a text file, you can confirm that with:
```
bandit9@bandit:~$ file data.txt 
data.txt: data
```

you cannot *grep* this file, what other way do we have available? read the man pages for `strings` command.

The command will print the strings of printable characters in files. If you try `strings data.txt`, that will give you all the data and you can eventually see the password, but you know it begins with several '=' characters, so you can *grep* for that:
```
bandit9@bandit:~$ strings data.txt | grep ====
2========== the
========== password
========== isa
========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk
```

## Level 10 → Level 11

> **Level Goal**
>
*The password for the next level is stored in the file data.txt, which contains base64 encoded data*

```
bandit10@bandit:~$ cat data.txt 
VGhlIHBhc3N3b3JkIGlzIElGdWt3S0dzRlc4TU9xM0lSRnFyeEUxaHhUTkViVVBSCg==
``` 

It's time to decode a string, how? see man page for `base64`.

```
bandit10@bandit:~$ cat data.txt | base64 -d
The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR
```

## Level 11 → Level 12

> **Level Goal**
>
*The password for the next level is stored in the file data.txt, where all lowercase (a-z) and uppercase (A-Z) letters have been rotated by 13 positions*

```
bandit11@bandit:~$ cat data.txt 
Gur cnffjbeq vf 5Gr8L4qetPEsPk8htqjhRK8XSP6x2RHh
```

You have a string that has been manipulated, meaning that all the letters have been switched for new ones, rotating 13 positions on the alphabet.

Looking at `Gur cnffjbeq vf 5Gr8L4qetPEsPk8htqjhRK8XSP6x2RHh` I can guess that the original text is `The password is...`

G -> T  
u -> h  
r -> e  

c -> p  
n -> a  
f -> s  
f -> s  
j -> w  
b -> o  
e -> r  
q -> d  

you can see the pattern... if you count the letters in the alphabet, you'll confirm that is in fact a 13 backwards position rotation. This is also known as a [ROT-13 cipher](https://en.wikipedia.org/wiki/ROT13).

So, how to reverse the process? You need to translate the characters of the string using the `tr` command.

Here you are telling `tr` to translate an 'A' to an 'N' and all other letters to a position 13 times ahead in the alphabet.
```
bandit11@bandit:~$ cat data.txt | tr '[A-Za-z]' '[N-ZA-Mn-za-m]'
The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu
```

## Level 12 → Level 13

> **Level Goal**
>
*The password for the next level is stored in the file data.txt, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under /tmp in which you can work using mkdir. For example: mkdir /tmp/myname123. Then copy the datafile using cp, and rename it using mv (read the manpages!)*

First, create a folder as mentioned in level goal:
```
bandit12@bandit:~$ mkdir /tmp/bml_1213
bandit12@bandit:~$ cp data.txt /tmp/bml_1213
bandit12@bandit:~$ cd /tmp/bml_1213
bandit12@bandit:/tmp/bml_1213$ ls
data.txt
bandit12@bandit:/tmp/bml_1213$ file data.txt 
data.txt: ASCII text
```
The file is an hexdump of the original file, so you need to revert it. You can do it by using the `xxd` command with the '-r' option (see man pages for more information).

Reverse the file and store it in a new file, then run the `file` command to see what was the original:
```
bandit12@bandit:/tmp/bml_1213$ xxd -r data.txt > reverse_data
bandit12@bandit:/tmp/bml_1213$ file reverse_data 
reverse_data: gzip compressed data, was "data2.bin", last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix
```
now we have a file compressed by `gzip` with an original file name of `data2.bin`. To uncompress the file, run the following command and check the man pages for more information
```
bandit12@bandit:/tmp/bml_1213$ gzip -d -k reverse_data 
gzip: reverse_data: unknown suffix -- ignored
```
I'm not sure what this error means, but try to change the file name to the original file name plus the `.gz` extension (to emulate the reverse process)
```
bandit12@bandit:/tmp/bml_1213$ mv reverse_data data2.bin.gz
bandit12@bandit:/tmp/bml_1213$ gzip -d -k data2.bin.gz
```
and now it works... we have a new file, of what type is this new file?
```
bandit12@bandit:/tmp/bml_1213$ ls
data2.bin  data2.bin.gz  data.txt
bandit12@bandit:/tmp/bml_1213$ file data2.bin
data2.bin: bzip2 compressed data, block size = 900k
```
is a file compressed by `bzip2`, go on and decompress it with '-d' and '-k' to keep the original file intact (see man pages).
```
bandit12@bandit:/tmp/bml_1213$ bzip2 -d -k data2.bin
bzip2: Can't guess original name for data2.bin -- using data2.bin.out
bandit12@bandit:/tmp/bml_1213$ file data2.bin.out
data2.bin.out: gzip compressed data, was "data4.bin", last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix
```
back to a gzip file, rename it for use with `gzip` once more
```
bandit12@bandit:/tmp/bml_1213$ mv data2.bin.out data4.bin.gz
bandit12@bandit:/tmp/bml_1213$ gzip -d -k data4.bin.gz
bandit12@bandit:/tmp/bml_1213$ ls
data2.bin  data2.bin.gz  data4.bin  data4.bin.gz  data.txt
bandit12@bandit:/tmp/bml_1213$ file data4.bin
data4.bin: POSIX tar archive (GNU)
```
now there's a tar archive file, so you can use `tar` do decompress it (see man pages)
```
bandit12@bandit:/tmp/bml_1213$ tar xvf data4.bin
data5.bin
bandit12@bandit:/tmp/bml_1213$ file data5.bin 
data5.bin: POSIX tar archive (GNU)
bandit12@bandit:/tmp/bml_1213$ tar xvf data5.bin
data6.bin
bandit12@bandit:/tmp/bml_1213$ file data6.bin 
data6.bin: bzip2 compressed data, block size = 900k
```
back to a `bzip2` file to decompress
```
bandit12@bandit:/tmp/bml_1213$ bzip2 -d -k data6.bin 
bzip2: Can't guess original name for data6.bin -- using data6.bin.out
bandit12@bandit:/tmp/bml_1213$ file data6.bin.out 
data6.bin.out: POSIX tar archive (GNU)
bandit12@bandit:/tmp/bml_1213$ tar xvf data6.bin.out
data8.bin
bandit12@bandit:/tmp/bml_1213$ file data8.bin 
data8.bin: gzip compressed data, was "data9.bin", last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix
```
and another `gzip`... rename the file as before
```
bandit12@bandit:/tmp/bml_1213$ mv data8.bin data9.bin.gz
bandit12@bandit:/tmp/bml_1213$ gzip -d -k data9.bin.gz
bandit12@bandit:/tmp/bml_1213$ ls
data2.bin     data4.bin     data5.bin  data6.bin.out  data9.bin.gz
data2.bin.gz  data4.bin.gz  data6.bin  data9.bin      data.txt
bandit12@bandit:/tmp/bml_1213$ file data9.bin
data9.bin: ASCII text
```
finally a text file!!! I hope that's the password...
```
bandit12@bandit:/tmp/bml_1213$ cat data9.bin
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
```

## Level 13 → Level 14

> **Level Goal**
>
*The password for the next level is stored in /etc/bandit_pass/bandit14 and can only be read by user bandit14. For this level, you don’t get the next password, but you get a private SSH key that can be used to log into the next level. Note: localhost is a hostname that refers to the machine you are working on*

In this level you have a file `sshkey.private`, that's a RSA private key... now it's a good time to read and learn something about [SSH Keys](https://www.ssh.com/ssh/key/). Check also the man pages for `ssh` for the `-i` option.

You know how to connect to the server via SSH using a private key.

You are currently connected as *bandit13*, so you don't have permission to display the content of the password file:
```
bandit13@bandit:~$ cat /etc/bandit_pass/bandit14
cat: /etc/bandit_pass/bandit14: Permission denied
```
so you need to login to the server as *bandit14* and read the file. Luckily you have a private key. You need to login to the same server (localhost) with the user *bandit14* using the private key file:
```
bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost
Could not create directory '/home/bandit13/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit13/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

Linux bandit 4.18.12 x86_64 GNU/Linux

[...]

Enjoy your stay!

bandit14@bandit:~$
```
so, now you are connected as *bandit14* and have permission to read the password file. When you're done, just exit the connection and you'll be back to your original connection for *bandit13*:
```
bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
bandit14@bandit:~$ exit
logout
Connection to localhost closed.
bandit13@bandit:~$
```
or, don't quit the connection and continue to the next level, as you are already connected... as you wish.

## Level 14 → Level 15

> **Level Goal**
>
*The password for the next level can be retrieved by submitting the password of the current level to port 30000 on localhost.*

You have to submit the password to a port on the server... you should learn the basics of [netcat](https://en.wikipedia.org/wiki/Netcat) for this one and don't forget to take a look at the man pages.

If you just connect to the server on port 30000, it will wait for a user input, in this case, type/paste the password:

```
bandit14@bandit:~$ nc localhost 30000
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr
```
another way is to `echo` the password and then pipe it to `nc`:
```
bandit14@bandit:~$ echo 4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e | nc localhost 30000
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr
```

## Level 15 → Level 16

> **Level Goal**
>
*The password for the next level can be retrieved by submitting the password of the current level to port 30001 on localhost using SSL encryption.*
>
*Helpful note: Getting “HEARTBEATING” and “Read R BLOCK”? Use -ign_eof and read the “CONNECTED COMMANDS” section in the manpage. Next to ‘R’ and ‘Q’, the ‘B’ command also works in this version of that command…*

Read the man pages for `openssl` and `s_client`, then connect to the server.

```
bandit15@bandit:~$ openssl s_client -connect localhost:30001
CONNECTED(00000003)
depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1
---
Certificate chain
 0 s:/CN=localhost
   i:/CN=localhost
---
Server certificate
-----BEGIN CERTIFICATE-----
MIICBjCCAW+gAwIBAgIEYo1NxTANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls
b2NhbGhvc3QwHhcNMjAwMTA1MTQzNTU4WhcNMjEwMTA0MTQzNTU4WjAUMRIwEAYD
VQQDDAlsb2NhbGhvc3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAKF4u2eu
a8VipZPviX0hfNiCnaD2ojAffdBhKTy1bmZSNRuHPBDnU7z8rblNSknSjCITda1C
GEAI8ZktRbtLpBTbYeTgqPN/EiN5UIRMKbU6P2O93zNFPBsmyfQLrgt+DSLnsxlB
i/yYyT7WLdtNVBpgwRwkqi9K7dk9vf9waswLAgMBAAGjZTBjMBQGA1UdEQQNMAuC
CWxvY2FsaG9zdDBLBglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0
ZWQgYnkgTmNhdC4gU2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3
DQEBBQUAA4GBAJECW6IB3Ria4xG002BqD3zEbtmrDlK6nmJq+uQ4eJ6cT18o9REb
npy/lFzlv2LfcrYAnuAp6Fh89MKaYjNzJURjRQ9RkmcYgQJa1n+OBkATb7V+84/a
k9PDRkscxdNFMGBSvzFD33XZ5lbaGdrwCPyoxenoYghV/753wffN7J6H
-----END CERTIFICATE-----
subject=/CN=localhost
issuer=/CN=localhost
---
No client certificate CA names sent
Peer signing digest: SHA512
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 1019 bytes and written 269 bytes
Verification error: self signed certificate
---
New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384
Server public key is 1024 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
SSL-Session:
    Protocol  : TLSv1.2
    Cipher    : ECDHE-RSA-AES256-GCM-SHA384
    Session-ID: CB8F02388C4AB743C2343113465229A31DE5ED4E5F94C30EFF628EEE38C8BE4E
    Session-ID-ctx: 
    Master-Key: BB5A8FE99C426E5825D840F512207A20D26E8FA834912664BADFF6541177568282C6790B68EF7890AC87DD3AF2112113
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - 56 e9 4e 87 6a 28 48 d0-13 42 5f b9 61 b0 dd d0   V.N.j(H..B_.a...
    0010 - 35 f5 ef de cd ca 17 61-71 bb 0f 6f 72 df 7b 9f   5......aq..or.{.
    0020 - 48 60 b4 c9 a0 e3 4d 08-a4 3c 73 d1 c6 93 a8 5f   H`....M..<s...._
    0030 - 19 24 37 9e fb 35 a1 18-cd 4c 50 12 88 4f 16 a1   .$7..5...LP..O..
    0040 - 89 c9 c0 1b a9 09 23 a6-cf c1 3b 25 06 9d 92 86   ......#...;%....
    0050 - 14 41 48 d9 29 7a 7c 7a-dd 74 92 e4 15 7d 8d a7   .AH.)z|z.t...}..
    0060 - 7e 89 ba 67 92 80 23 7e-b0 23 a9 ac 8a bb 8e f7   ~..g..#~.#......
    0070 - 0e c2 59 92 df 01 fc 1f-d5 c8 64 30 3e dc 2d 9d   ..Y.......d0>.-.
    0080 - e0 9a be 73 2b 90 6b 48-80 f4 c4 5d df b1 1d bc   ...s+.kH...]....
    0090 - 18 04 ea cc ff f3 76 47-19 16 ad f8 c4 77 85 3a   ......vG.....w.:

    Start Time: 1586424140
    Timeout   : 7200 (sec)
    Verify return code: 18 (self signed certificate)
    Extended master secret: yes
---
```
and then type/paste the password:
```
BfMYroe26WYalil77FoDi9qh59eK5xNr
Correct!
cluFn7wTiGryunymYOu4RcffSxQluehd

closed
```
I didn't have any error, but if you read carefully the man pages for `s_client`, you will know that some conditions will terminate the connection, like starting the user input with an 'R':

```
---
Raa
RENEGOTIATING
depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1
write:errno=104
```
or with a 'Q':
```
---
Q
DONE
```
you can fix that using the `-ign_eof` option, that way the user input does not cause any error and the password verification is done correctly:
```
bandit15@bandit:~$ openssl s_client -connect localhost:30001 -ign_eof
[...]
---
Raa
Wrong! Please enter the correct current password
closed

bandit15@bandit:~$ openssl s_client -connect localhost:30001 -ign_eof
[...]
---
Q
Wrong! Please enter the correct current password
closed
```
it could have been significant if the correct password started with a 'R' or 'Q'...

## Level 16 → Level 17

> **Level Goal**
>
*The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range 31000 to 32000. First find out which of these ports have a server listening on them. Then find out which of those speak SSL and which don’t. There is only 1 server that will give the next credentials, the others will simply send back to you whatever you send to it.*

You have to scan the server for open ports, so take a look at `namp` man pages.. there are several options for *nmap* scans, depending on the choices, the scan can run quickly or take a long time...

This is a simple scan to find out just open ports:
```
bandit16@bandit:~$ nmap -T4 -p 31000-32000 localhost

Starting Nmap 7.40 ( https://nmap.org ) at 2020-04-09 11:47 CEST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00024s latency).
Not shown: 999 closed ports
PORT      STATE    SERVICE
31518/tcp filtered unknown
31790/tcp open     unknown

Nmap done: 1 IP address (1 host up) scanned in 1.26 seconds
```
and this is a way to find out, not just the ports, but also extra information about those ports:
```
bandit16@bandit:~$ nmap -A -T4 -p 31000-32000 localhost

Starting Nmap 7.40 ( https://nmap.org ) at 2020-04-09 11:47 CEST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00027s latency).
Not shown: 999 closed ports
PORT      STATE    SERVICE     VERSION
31518/tcp filtered unknown
31790/tcp open     ssl/unknown
| fingerprint-strings: 
|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, TLSSessionReq: 
|_    Wrong! Please enter the correct current password
| ssl-cert: Subject: commonName=localhost
| Subject Alternative Name: DNS:localhost
| Not valid before: 2020-04-06T22:32:42
|_Not valid after:  2021-04-06T22:32:42
|_ssl-date: TLS randomness does not represent time
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port31790-TCP:V=7.40%T=SSL%I=7%D=4/9%Time=5E8EEF5A%P=x86_64-pc-linux-gn
SF:u%r(GenericLines,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20cur
SF:rent\x20password\n")%r(GetRequest,31,"Wrong!\x20Please\x20enter\x20the\
SF:x20correct\x20current\x20password\n")%r(HTTPOptions,31,"Wrong!\x20Pleas
SF:e\x20enter\x20the\x20correct\x20current\x20password\n")%r(RTSPRequest,3
SF:1,"Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n
SF:")%r(Help,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x2
SF:0password\n")%r(SSLSessionReq,31,"Wrong!\x20Please\x20enter\x20the\x20c
SF:orrect\x20current\x20password\n")%r(TLSSessionReq,31,"Wrong!\x20Please\
SF:x20enter\x20the\x20correct\x20current\x20password\n")%r(Kerberos,31,"Wr
SF:ong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n")%r(
SF:FourOhFourRequest,31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20cu
SF:rrent\x20password\n")%r(LPDString,31,"Wrong!\x20Please\x20enter\x20the\
SF:x20correct\x20current\x20password\n")%r(LDAPSearchReq,31,"Wrong!\x20Ple
SF:ase\x20enter\x20the\x20correct\x20current\x20password\n")%r(SIPOptions,
SF:31,"Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\
SF:n");

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 89.49 seconds
```
you can see the time difference comparing the time at the end of each scan.

so, there are just 2 ports (31518 and 31790), one open and one filtered (as you may have seen in the man pages, *filtered* means that *nmap* cannot determine whether the port is open because packet filtering prevents its probes from reaching the port).

try to connect to the open port using `openssl` as before:
```
bandit16@bandit:~$ openssl s_client -connect localhost:31790
CONNECTED(00000003)
depth=0 CN = localhost
verify error:num=18:self signed certificate
verify return:1
depth=0 CN = localhost
verify return:1
---
Certificate chain
 0 s:/CN=localhost
   i:/CN=localhost
---
Server certificate
-----BEGIN CERTIFICATE-----
MIICBjCCAW+gAwIBAgIEBKMOoTANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls
b2NhbGhvc3QwHhcNMjAwNDA2MjIzMjQyWhcNMjEwNDA2MjIzMjQyWjAUMRIwEAYD
VQQDDAlsb2NhbGhvc3QwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALags2qr
lWfnM53o914J6CWEJ/gm8EnVrIzBRKUvWzHfiviUw9pcRDPb4sisxcrwts23fzh4
LDGAuytnRxe5CeVmdJm+wNYK0tKR5FHwGgicDShmj+THsCiPRlF25jhgPZwKt2zs
m5IFth2KrMI1PmBYpV7Kdomw/6E61Z6qIj1zAgMBAAGjZTBjMBQGA1UdEQQNMAuC
CWxvY2FsaG9zdDBLBglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0
ZWQgYnkgTmNhdC4gU2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3
DQEBBQUAA4GBAJBZ5d4MkQZi3o1aQYdcoqF5skeRHBiurIKzIruuAxY0A+3BY46J
4HXHlslM0PAGnpSFVs0iEV3dgDtSW+pZECbycZpuZ5auOxkQ0on/2Zx0OXzQUbYP
j4xvM1i8c8NpUqmFMcSn4ND+5nLI53ka6DE4PVfsxfPHa3IIJoV4yE9a
-----END CERTIFICATE-----
subject=/CN=localhost
issuer=/CN=localhost
---
No client certificate CA names sent
Peer signing digest: SHA512
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 1019 bytes and written 269 bytes
Verification error: self signed certificate
---
New, TLSv1.2, Cipher is ECDHE-RSA-AES256-GCM-SHA384
Server public key is 1024 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
SSL-Session:
    Protocol  : TLSv1.2
    Cipher    : ECDHE-RSA-AES256-GCM-SHA384
    Session-ID: 71EC37D166AE59FC0A4281E44832CBB74D58D60C7132A4B1DBA4D7E2C086F5BB
    Session-ID-ctx: 
    Master-Key: E6CBE617AB52D039DDFCCBAF6DC5FB5F5ADA789F7E44C325918A0F24B81F390368A564DF1021061B53E159328AA30360
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - 8e 9a 4d ec 1c f4 6b 35-30 ba 86 7d cf 4c 4a 6d   ..M...k50..}.LJm
    0010 - 7d 21 2a 2a 64 41 93 e3-46 d1 16 e7 00 37 8e 3c   }!**dA..F....7.<
    0020 - 96 0a 89 43 dc 3a 42 36-65 e4 59 da b5 97 d2 50   ...C.:B6e.Y....P
    0030 - 76 fc d0 41 42 73 fb 13-19 90 a1 53 79 b6 a1 6b   v..ABs.....Sy..k
    0040 - d5 52 25 33 0b a8 28 fb-b5 f2 31 7a e6 ab 4c a5   .R%3..(...1z..L.
    0050 - 66 cd ba 3e 19 7e d0 a6-db 52 d9 0f 3e eb b4 99   f..>.~...R..>...
    0060 - 1b 84 a4 b6 a9 b0 96 59-37 9c 5b c2 1b ff 39 7a   .......Y7.[...9z
    0070 - 26 d3 4a a0 4e de 91 8f-0a 5c c0 1c 0b 11 2c c9   &.J.N....\....,.
    0080 - 9d e9 8c a5 f8 53 e0 bd-d9 01 68 ea 3e 4f a2 8b   .....S....h.>O..
    0090 - 79 95 db 76 be d1 ff e5-76 61 2b 58 07 2e 12 6e   y..v....va+X...n

    Start Time: 1586426534
    Timeout   : 7200 (sec)
    Verify return code: 18 (self signed certificate)
    Extended master secret: yes
---
cluFn7wTiGryunymYOu4RcffSxQluehd
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----

closed
```

this time, the credential returned by the server it's not a password, it's a private key. Copy the private key and store it in a file on your local machine, then use it to connect via SSH to the server.  

Should be something similar to my connection:
```
bml@ubuntu:~/overthewire/bandit$ ssh -i level16/sshkey.private bandit17@bandit.labs.overthewire.org -p 2220
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0644 for 'level16/sshkey.private' are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key "level16/sshkey.private2": bad permissions
bandit17@bandit.labs.overthewire.org's password:
```
there is a warning and ssh asks for the password! That's because of the permissions of the key file (by default, 0644 so that others can use it). So you need to change the permissions of the file, so it's NOT accessible by others. Now is a good time to learn something about [Linux file permissions](https://www.linux.com/training-tutorials/understanding-linux-file-permissions/).

Change the file permissions to 600 and then you can connect normally.
```
bml@ubuntu:~/overthewire/bandit$ chmod 600 level16/sshkey.private
bml@ubuntu:~/overthewire/bandit$ ssh -i level16/sshkey.private bandit17@bandit.labs.overthewire.org -p 2220
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
[...]
  Enjoy your stay!

bandit17@bandit:~$
```

## Level 17 → Level 18

> **Level Goal**
>
*There are 2 files in the homedirectory: passwords.old and passwords.new. The password for the next level is in passwords.new and is the only line that has been changed between passwords.old and passwords.new*
>
*NOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19*

There is a `diff` command that will allow you to check the differences between files, check the man pages.

```
bandit17@bandit:~$ ls
passwords.new  passwords.old
bandit17@bandit:~$ diff passwords.old passwords.new
42c42
< hlbSBPAWJmL6WFDb06gpTx1pPButblOA
---
> kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
```

when you use the password to connect for the next level, the server connects but ends the connection immediately:
```
bml@ubuntu:~/overthewire/bandit$ ssh bandit18@bandit.labs.overthewire.org -p 2220
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
Linux bandit 4.18.12 x86_64 GNU/Linux

  Enjoy your stay!

Byebye !
Connection to bandit.labs.overthewire.org closed.
```
that is an intended behavior, see the next level.

## Level 18 → Level 19

> **Level Goal**
>
*The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH.*

You know that you connect successfully to the server, but the connection is terminated by `.bashrc`... take some time to read information about this special file, the file location and what it's supposed to do. Also review the man pages for `ssh`, find out how to execute commands directly in the initial connection.

Now that you know where *.bashrc* is located and how to execute commands, try to *cat* *.bashrc*
```
bml@ubuntu:~/overthewire/bandit$ ssh bandit18@bandit.labs.overthewire.org -p 2220 'cat .bashrc'
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
# ~/.bashrc: executed by bash(1) for non-login shells.
# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)
# for examples

[...]

fi
echo 'Byebye !'
exit 0
```
the final instruction from *.bashrc* is to `exit 0`, so take a look at `exit` man pages. The *.bashrc* script is terminating the connection with code 0 (success) and there is nothing that you can do about it.

But you can execute commands before the connection is closed, try to list files:
```
bml@ubuntu:~/overthewire/bandit$ ssh bandit18@bandit.labs.overthewire.org -p 2220 ls
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
readme
```
you have confirmed that the file *readme* actually exists and now you can read it:
```
bml@ubuntu:~/overthewire/bandit$ ssh bandit18@bandit.labs.overthewire.org -p 2220 'cat readme'
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x
```
you can also copy the file back to your local machine with `scp` command (see man pages):
```
bml@ubuntu:~/overthewire/bandit$ scp -P 2220 bandit18@bandit.labs.overthewire.org:/home/bandit18/readme .
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
readme                                                                    100%   33     0.5KB/s   00:00    
bml@ubuntu:~/overthewire/bandit$ cat readme 
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x
```

## Level 19 → Level 20

> **Level Goal**
>
*To gain access to the next level, you should use the setuid binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (/etc/bandit_pass), after you have used the setuid binary.*

Find what type of file is `bandit20-do`:
```
bandit19@bandit:~$ file bandit20-do 
bandit20-do: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=8e941f24b8c5cd0af67b22b724c57e1ab92a92a1, not stripped
```
now go and find out how to run an executable file in Linux, then execute the file:
```
bandit19@bandit:~$ ./bandit20-do 
Run a command as another user.
  Example: ./bandit20-do id
```
if you try to read the password file directly, you can't, because you are *bandit19*:
```
bandit19@bandit:~$ cat /etc/bandit_pass/bandit20
cat: /etc/bandit_pass/bandit20: Permission denied
bandit19@bandit:~$ whoami
bandit19
```
but if you use the command as an argument to the executable file, you are running the command as *bandit20*:
```
bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
bandit19@bandit:~$ ./bandit20-do whoami
bandit20
```

## Level 20 → Level 21

> **Level Goal**
>
*There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).*
>
*NOTE: Try connecting to your own network daemon to see if it works as you think*

So, the server has an executable that will connect to a port and waits for a password. When the password is received, it will verify if it's the correct password for this level and return the password for the next level. For this one you need to run 2 commands at the same time, so you need to understand [job control in Linux](http://www.aboutlinux.info/2005/05/job-control-in-linux.html) or know how to use [screen](https://linuxize.com/post/how-to-use-linux-screen/) or [tmux](https://www.hamvocke.com/blog/a-quick-and-easy-guide-to-tmux/).

Running *screen* or *tmux* is easier and you can see all the interactions in the screen at the same time, I will use panes in *tmux* from now on.

First split the screen vertically with `Crtl+b %` and return to the left pane with `Crtl+b ;`:
![tmux split panes](/images/bandit/tmux_init.png)

next start a listener with netcat on your chosen port (I used port 4275):
![set up a listener](/images/bandit/tmux_listener.png)

now you can navigate to the right pane with `Crtl+b ;` and execute *suconnect* with the port as an argument:
![run suconnect](/images/bandit/tmux_wait_for_pass.png)

that will open the connection to the listener and now you have to navigate back to the left pane, type/paste the password and press *Enter*:
![receive password](/images/bandit/tmux_insert_pass.png)

the *suconnect* program will receive the password and transmit back the password for the next level:
![receive password](/images/bandit/tmux_end.png)

## Level 21 → Level 22

> **Level Goal**
>
*A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.*

Take a look at `cron` man pages to understand what are *cron jobs*.

then list all jobs in the specified folder:
```
bandit21@bandit:~$ ls /etc/cron.d/
atop  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24
```
find out what's inside the file *cronjob_bandit22*:
```
bandit21@bandit:~$ cat /etc/cron.d/cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &> /dev/null
```
it looks like the script */usr/bin/cronjob_bandit22.sh* is being executed, look inside the script:
```
bandit21@bandit:~$ cat /usr/bin/cronjob_bandit22.sh
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 > /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
```
ok, the password is being written in this temporary folder and the folder has 644 permissions, so it will be readable by others:
```
bandit21@bandit:~$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
```

## Level 22 → Level 23

> **Level Goal**
>
*A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.*
>
*NOTE: Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. If you are having problems understanding what it does, try executing it to see the debug information it prints.*

Find out what is running as a *cron job* (same as previous level):
```
bandit22@bandit:~$ ls /etc/cron.d/
atop  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24
bandit22@bandit:~$ cat /etc/cron.d/cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &> /dev/null
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &> /dev/null
bandit22@bandit:~$ cat /usr/bin/cronjob_bandit23.sh
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"

cat /etc/bandit_pass/$myname > /tmp/$mytarget
```
this is a bash script, you can replicate everything in the command line, but first, try to understand what the script is doing... 

 - the line `#!/bin/bash` indicates that is a bash script
 - `myname=$(whoami)` here the `whoami` command is executed and assigned to the *myname* variable, so *myname* will have the value of the user who runs the script, in this case, *bandit23*
 - `mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)` here the *mytarget* variable is receiving the result of *echo I am user bandit23 \| md5sum \| cut -d ' ' -f 1)*
 - `echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"` is just a printed message to the user
 - `cat /etc/bandit_pass/$myname > /tmp/$mytarget` is copying the contents of file */etc/bandit_pass/bandit23* to */tmp/$mytarget* and *$mytarget* is the command from above

you can search online and see the man pages for `md5sum` and `cut` to understand what the third line of the script is doing and then run the command and get the result and the password:
```
bandit22@bandit:~$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1
8ca319486bfbbc3663ea0fbe81326349
bandit22@bandit:~$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
```

## Level 23 → Level 24

> **Level Goal**
>
*A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.*
>
*NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level!*
>
*NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy around…*

Start by looking again at */etc/cron.d/*, list all *cron jobs* and *cat* the job for this level:
```
bandit23@bandit:~$ ls /etc/cron.d
atop  cronjob_bandit22  cronjob_bandit23  cronjob_bandit24
bandit23@bandit:~$ cat /etc/cron.d/cronjob_bandit24
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
bandit23@bandit:~$ cat /usr/bin/cronjob_bandit24.sh
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname
echo "Executing and deleting all scripts in /var/spool/$myname:"
for i in * .*;
do
    if [ "$i" != "." -a "$i" != ".." ];
    then
        echo "Handling $i"
        timeout -s 9 60 ./$i
        rm -f ./$i
    fi
done
```
try to understand the script... it is executing all scripts in */var/spool/bandit24* and then deleting them.

What can you do with this? well, if the script runs all scripts in the folder, can you access that folder and put your own script in there?

start by making a temp folder to keep the server clean, then create a script file with the `touch` command (yes, is an empty file, just to see if you can copy it to the folder). Try to copy the file and confirm that the file is there.
```
bandit23@bandit:~$ mkdir /tmp/bml_2324
bandit23@bandit:~$ cd /tmp/bml_2324
bandit23@bandit:/tmp/bml_2324$ touch level24.sh
bandit23@bandit:/tmp/bml_2324$ cp level24.sh /var/spool/bandit24/
bandit23@bandit:/tmp/bml_2324$ ls /var/spool/bandit24/level24.sh
/var/spool/bandit24/level24.sh
```
ok, so you can copy the script to the folder and that script will run as *bandit24* because it is invoked by the *cron job*. All you have to do is to write a script that copies the password of *bandit24* to your temp folder and then copy the script again to */var/spool/bandit24*
```
bandit23@bandit:/tmp/bml_2324$ vim level24.sh

[--- to edit the script, use your favorite text editor ---]

bandit23@bandit:/tmp/bml_2324$ cat level24.sh 
cat /etc/bandit_pass/bandit24 > /tmp/bml_2324/pass.txt
bandit23@bandit:/tmp/bml_2324$ cp level24.sh /var/spool/bandit24/
bandit23@bandit:/tmp/bml_2324$ ls
level24.sh
```
wait a few moments (the *cron job* runs every minute) and check your temp folder:
```
bandit23@bandit:/tmp/bml_2324$ ls
level24.sh
```
nothing... why? I'll give you a hint:
```
bandit23@bandit:/tmp/bml_2324$ ls -la level24.sh 
-rw-r--r-- 1 bandit23 root 55 Apr  9 17:50 level24.sh
```
the script doesn't have the appropriate permissions to run! you have to change the permissions on the script file and also on the temp folder, otherwise the *cron job* will not be able to run the script.
```
bandit23@bandit:/tmp/bml_2324$ chmod 777 level24.sh 
bandit23@bandit:/tmp/bml_2324$ chmod 777 /tmp/bml_2324
```
now copy the script again and wait for the password to appear on your temp folder:
```
bandit23@bandit:/tmp/bml_2324$ cp level24.sh /var/spool/bandit24/

[--- after a few moments ---]

bandit23@bandit:/tmp/bml_2324$ ls
level24.sh  pass.txt
bandit23@bandit:/tmp/bml_2324$ cat pass.txt 
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
```

## Level 24 → Level 25

> **Level Goal**
>
*A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing.*

You have to connect to the server on port 30002:
```
bandit24@bandit:~$ nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
```
it will ask for the password and a pincode, try it out:
```
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 0000
Wrong! Please enter the correct pincode. Try again.
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 1111
Wrong! Please enter the correct pincode. Try again.
^C
```
you know the password, but not the pin... with so many possible combinations, you have to brute force. Write a script or do a *oneliner*, it's up to you... create a temp folder and generate a file with all combinations for the 4-digit pincode:
```
bandit24@bandit:~$ mkdir /tmp/bml_2425 && cd /tmp/bml_2425
bandit24@bandit:/tmp/bml_2425$ for pin in {0000..9999}; do echo UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ $pin >> pincodes.txt; done
bandit24@bandit:/tmp/bml_2425$ cat pincodes.txt | wc -l
10000
bandit24@bandit:/tmp/bml_2425$ tail pincodes.txt 
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9990
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9991
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9992
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9993
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9994
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9995
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9996
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9997
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9998
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9999
```
now you have all combinations, send them to the port:
```
bandit24@bandit:/tmp/bml_2425$ cat pincodes.txt | nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
[...]
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again. -n
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
Timeout. Exiting.
```
sometimes the server will timeout, you could keep trying until it works, or go creative... send the last 5000 pincodes for example:
```
bandit24@bandit:/tmp/bml_2425$ tail -n 5000 pincodes.txt | nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
[...]
Wrong! Please enter the correct pincode. Try again.
Wrong! Please enter the correct pincode. Try again.
Correct!
The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG

Exiting.
```

## Level 25 → Level 26

> **Level Goal**
>
*Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 is not /bin/bash, but something else. Find out what it is, how it works and how to break out of it.*

In the home folder, you have an ssh key and you already know how to connect:
```
bandit25@bandit:~$ ls
bandit26.sshkey
bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost
Could not create directory '/home/bandit25/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

Linux bandit 4.18.12 x86_64 GNU/Linux

[...]

Enjoy your stay!

  _                     _ _ _   ___   __  
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \ 
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/ 
Connection to localhost closed.
```
Hmmm... what is going on here?

You have a hint in the level goal above: *The shell for user bandit26 is not /bin/bash, but something else.*

how can you see what shell is it? learn by searching for information about a special file in Linux `/etc/passwd`. 

Try to *grep* */etc/passwd* for the entries for *bandit25* and *bandit26*:
```
bandit25@bandit:~$ cat /etc/passwd | grep -E 'bandit26|bandit25'
bandit25:x:11025:11025:bandit level 25:/home/bandit25:/bin/bash
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
```
you can see that the shell for *bandit25* is */bin/bash*, but for *bandit26* is */usr/bin/showtext*

read that file and see what is it:
```
bandit25@bandit:~$ cat /usr/bin/showtext
#!/bin/sh

export TERM=linux

more ~/text.txt
exit 0
```
basically, at login it will execute `more ~/text.txt` and terminate the connection. And, looking back at the first connection, the contents of *text.txt* must be:
```
  _                     _ _ _   ___   __  
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \ 
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/ 
```
what can you do with this information? first, learn how the `more` command works. There is a hint in the man pages, can you find it? Read the section COMMANDS... 'v' option.

so what you need to do is:
 - prevent *more* from exit
 - start an editor inside *more*
 - escape to a shell and get the password for next level
 
you can also read the password from the current level from inside the editor if you want, but you don't need it anyway...

to prevent *more* from exiting, reduce your terminal height so that the text from *text.txt* is unable to fit the screen, that way *more* will pause:
![pause more](/images/bandit/more_command.png)

with *more* waiting, start an editor pressing *v* (it will open `vi`, take a look at the man pages).

To enter command mode in *vi* press 'ESC' then type ':' to enter a command.

You need to change the shell type, so type `:set shell=/bin/bash` and press 'Enter', then type `:shell` and press 'Enter' again.

You can now resize your terminal as you wish. 

Don't exit, because the next level starts right here!

Additional info: as I have mentioned earlier, to get *bandit26* password inside `vi`, just type ':e ' followed by the path to the file (but you don't need that for this level):
![open file with vi](/images/bandit/more_password.png)

## Level 26 → Level 27

> **Level Goal**
>
*Good job getting a shell! Now hurry and grab the password for bandit27!*

There is an executable file `bandit27-do` that will run commands as *bandit27* and that is exactly what you need to be able to get the password:
```
| |                   | (_) | |__ \ / /
 | |__   __ _ _ __   __| |_| |_   ) / /_
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \
:shell
bandit26@bandit:~$ ls
bandit27-do  text.txt
bandit26@bandit:~$ cat /etc/bandit_pass/bandit27
cat: /etc/bandit_pass/bandit27: Permission denied                                                           
bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27
3ba3118a22e93127a4ed485be72ef5ea 
```

## Level 27 → Level 28

> **Level Goal**
>
*There is a git repository at ssh://bandit27-git@localhost/home/bandit27-git/repo. The password for the user bandit27-git is the same as for the user bandit27.*

You will start a series of challenges concerning the `git` command... read the man pages.

We need to clone a repository, so create a temporary folder:
```
bandit27@bandit:~$ mkdir /tmp/bml_2728 && cd /tmp/bml_2728
```
and now you need to clone the repo with ssh:
```
bandit27@bandit:/tmp/bml_2728$ git clone ssh://bandit27-git@localhost/home/bandit27-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit27/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit27-git@localhost's password: 
remote: Counting objects: 3, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (3/3), done.
```
now you should have a repo folder in the server:
```
bandit27@bandit:/tmp/bml_2728$ ls
repo
bandit27@bandit:/tmp/bml_2728$ cd repo
bandit27@bandit:/tmp/bml_2728/repo$ ls
README
bandit27@bandit:/tmp/bml_2728/repo$ cat README 
The password to the next level is: 0ef186ac70e04ea33b4c1853d2526fa2
```

## Level 28 → Level 29

> **Level Goal**
>
*There is a git repository at ssh://bandit28-git@localhost/home/bandit28-git/repo. The password for the user bandit28-git is the same as for the user bandit28.*
>
*Clone the repository and find the password for the next level.*

Same as last level:
```
bandit28@bandit:~$ mkdir /tmp/bml_2829 && cd /tmp/bml_2829
bandit28@bandit:/tmp/bml_2829$ git clone ssh://bandit28-git@localhost/home/bandit28-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit28/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit28-git@localhost's password: 
remote: Counting objects: 9, done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 9 (delta 2), reused 0 (delta 0)
Receiving objects: 100% (9/9), done.
Resolving deltas: 100% (2/2), done.
bandit28@bandit:/tmp/bml_2829$ ls
repo
bandit28@bandit:/tmp/bml_2829$ cd repo
bandit28@bandit:/tmp/bml_2829/repo$ ls
README.md
bandit28@bandit:/tmp/bml_2829/repo$ cat README.md 
# Bandit Notes
Some notes for level29 of bandit.

## credentials

- username: bandit29
- password: xxxxxxxxxx
```
hmmm... maybe *xxxxxxxxxx* has been altered after initial commit with the password... first take a look at this [documentation](https://git-scm.com/book/en/v2/Git-Basics-Viewing-the-Commit-History), it will help you solve this one.

try to view git log:
```
bandit28@bandit:/tmp/bml_2829/repo$ git log
commit 073c27c130e6ee407e12faad1dd3848a110c4f95
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 16 14:00:39 2018 +0200

    fix info leak

commit 186a1038cc54d1358d42d468cdc8e3cc28a93fcb
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 16 14:00:39 2018 +0200

    add missing data

commit b67405defc6ef44210c53345fc953e6a21338cc7
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:39 2018 +0200

    initial commit of README.md
```
ok, 3 commits and one promising note `fix info leak` that confirms that the password was there in a previous commit.

now you can view the differences from the last commit:
```
bandit28@bandit:/tmp/bml_2829/repo$ git log -p -1
commit 073c27c130e6ee407e12faad1dd3848a110c4f95
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 16 14:00:39 2018 +0200

    fix info leak

diff --git a/README.md b/README.md
index 3f7cee8..5c6457b 100644
--- a/README.md
+++ b/README.md
@@ -4,5 +4,5 @@ Some notes for level29 of bandit.
 ## credentials
 
 - username: bandit29
-- password: bbc96594b4e001778eee9975372716b2
+- password: xxxxxxxxxx
```

## Level 29 → Level 30

> **Level Goal**
>
*There is a git repository at ssh://bandit29-git@localhost/home/bandit29-git/repo. The password for the user bandit29-git is the same as for the user bandit29.*
>
*Clone the repository and find the password for the next level.*

Clone the repo once again:
```
bandit29@bandit:~$ mkdir /tmp/bml_2930 && cd /tmp/bml_2930
bandit29@bandit:/tmp/bml_2930$ git clone ssh://bandit29-git@localhost/home/bandit29-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit29/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit29/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit29-git@localhost's password: 
remote: Counting objects: 16, done.
remote: Compressing objects: 100% (11/11), done.
remote: Total 16 (delta 2), reused 0 (delta 0)
Receiving objects: 100% (16/16), done.
Resolving deltas: 100% (2/2), done.
bandit29@bandit:/tmp/bml_2930$ ls
repo
bandit29@bandit:/tmp/bml_2930$ cd repo
bandit29@bandit:/tmp/bml_2930/repo$ ls
README.md
bandit29@bandit:/tmp/bml_2930/repo$ cat README.md 
# Bandit Notes
Some notes for bandit30 of bandit.

## credentials

- username: bandit30
- password: <no passwords in production!>
```
nothing relevante in log:
```
bandit29@bandit:/tmp/bml_2930/repo$ git log
commit 84abedc104bbc0c65cb9eb74eb1d3057753e70f8
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    fix username

commit 9b19e7d8c1aadf4edcc5b15ba8107329ad6c5650
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    initial commit of README.md
```
they mention *production*, so maybe there are other branches for this repo... read the help for *show-branch* by typing `git show-branch --help`. 
```
bandit29@bandit:/tmp/bml_2930/repo$ git show-branch -a
* [master] fix username
 ! [origin/HEAD] fix username
  ! [origin/dev] add data needed for development
   ! [origin/master] fix username
    ! [origin/sploits-dev] add some silly exploit, just for shit and giggles
-----
    + [origin/sploits-dev] add some silly exploit, just for shit and giggles
  +   [origin/dev] add data needed for development
  +   [origin/dev^] add gif2ascii
*++++ [master] fix username
```
ok, there is an *origin/dev* branch that can be interesting... so try to switch to dev branch:
```
bandit29@bandit:/tmp/bml_2930/repo$ git checkout dev
Branch dev set up to track remote branch dev from origin.
Switched to a new branch 'dev'
bandit29@bandit:/tmp/bml_2930/repo$ git branch
* dev
  master
  origin/dev
```
now view the log for this new branch:
```
bandit29@bandit:/tmp/bml_2930/repo$ git log
commit 33ce2e95d9c5d6fb0a40e5ee9a2926903646b4e3
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    add data needed for development

commit a8af722fccd4206fc3780bd3ede35b2c03886d9b
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    add gif2ascii

commit 84abedc104bbc0c65cb9eb74eb1d3057753e70f8
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    fix username

commit 9b19e7d8c1aadf4edcc5b15ba8107329ad6c5650
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    initial commit of README.md
```
see what *add data needed for development* is all about:
```
bandit29@bandit:/tmp/bml_2930/repo$ git log -p -1
commit 33ce2e95d9c5d6fb0a40e5ee9a2926903646b4e3
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 16 14:00:41 2018 +0200

    add data needed for development

diff --git a/README.md b/README.md
index 1af21d3..39b87a8 100644
--- a/README.md
+++ b/README.md
@@ -4,5 +4,5 @@ Some notes for bandit30 of bandit.
 ## credentials
 
 - username: bandit30
-- password: <no passwords in production!>
+- password: 5b90576bedb2cc04c86a9e924ce42faf
```

## Level 30 → Level 31

> **Level Goal**
>
*There is a git repository at ssh://bandit30-git@localhost/home/bandit30-git/repo. The password for the user bandit30-git is the same as for the user bandit30.*
>
*Clone the repository and find the password for the next level.*

Clone one more repo...
```
bandit30@bandit:~$ mkdir /tmp/bml_3031 && cd /tmp/bml_3031
bandit30@bandit:/tmp/bml_3031$ git clone ssh://bandit30-git@localhost/home/bandit30-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit30/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit30/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit30-git@localhost's password: 
remote: Counting objects: 4, done.
remote: Total 4 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (4/4), done.
bandit30@bandit:/tmp/bml_3031$ ls
repo
bandit30@bandit:/tmp/bml_3031$ cd repo
bandit30@bandit:/tmp/bml_3031/repo$ ls
README.md
bandit30@bandit:/tmp/bml_3031/repo$ cat README.md 
just an epmty file... muahaha
```
some recon on the repo:
```
bandit30@bandit:/tmp/bml_3031/repo$ git log
commit 3aa4c239f729b07deb99a52f125893e162daac9e
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 16 14:00:44 2018 +0200

    initial commit of README.md
bandit30@bandit:/tmp/bml_3031/repo$ git branch -a
* master
  remotes/origin/HEAD -> origin/master
  remotes/origin/master
```
try something new... git tagging!
```
bandit30@bandit:/tmp/bml_3031/repo$ git tag
secret
bandit30@bandit:/tmp/bml_3031/repo$ git show secret
47e603bb428404d265f59c42920d81e5
```

## Level 31 → Level 32

> **Level Goal**
>
*There is a git repository at ssh://bandit31-git@localhost/home/bandit31-git/repo. The password for the user bandit31-git is the same as for the user bandit31.*
>
*Clone the repository and find the password for the next level.*

Here we go again...
```
bandit31@bandit:~$ mkdir /tmp/bml_3132 && cd /tmp/bml_3132
bandit31@bandit:/tmp/bml_3132$ git clone ssh://bandit31-git@localhost/home/bandit31-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit31/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit31-git@localhost's password: 
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 4 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (4/4), done.
bandit31@bandit:/tmp/bml_3132$ ls
repo
bandit31@bandit:/tmp/bml_3132$ cd repo
bandit31@bandit:/tmp/bml_3132/repo$ ls
README.md
bandit31@bandit:/tmp/bml_3132/repo$ cat README.md 
This time your task is to push a file to the remote repository.

Details:
    File name: key.txt
    Content: 'May I come in?'
    Branch: master
```
so, you need to create a new file *key.txt* with the content *May I come in?* and add the file to git:
```
bandit31@bandit:/tmp/bml_3132/repo$ echo "May I come in?" > key.txt
bandit31@bandit:/tmp/bml_3132/repo$ git add key.txt 
The following paths are ignored by one of your .gitignore files:
key.txt
Use -f if you really want to add them.
```
there is an error saying that *.gitignore* is preventing the file to be added... you need to check what files is *.gitignore* preventing to be added:
```
bandit31@bandit:/tmp/bml_3132/repo$ cat .gitignore 
*.txt
```
ok, all files with the extension *.txt*... exactly what we need to add, so you can remove the *.gitignore* and try again:
```
bandit31@bandit:/tmp/bml_3132/repo$ rm .gitignore 
bandit31@bandit:/tmp/bml_3132/repo$ git add key.txt 
```
all good now, but you still need to commit the changes and then push the new file to git:
```
bandit31@bandit:/tmp/bml_3132/repo$ git commit -m "added key.txt"
[master ae683a7] added key.txt
 1 file changed, 1 insertion(+)
 create mode 100644 key.txt
bandit31@bandit:/tmp/bml_3132/repo$ git push
Could not create directory '/home/bandit31/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit31-git@localhost's password: 
Counting objects: 3, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (3/3), 325 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
remote: ### Attempting to validate files... ####
remote: 
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote: 
remote: Well done! Here is the password for the next level:
remote: 56a9bf19c63d650ce78e6ec0354ee45e
remote: 
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote: 
To ssh://localhost/home/bandit31-git/repo
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'ssh://bandit31-git@localhost/home/bandit31-git/repo'
```

## Level 32 → Level 33

> **Level Goal**
>
*After all this git stuff its time for another escape. Good luck!*

```
bml@ubuntu:~/overthewire/bandit$ ssh bandit32@bandit.labs.overthewire.org -p 2220
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit32@bandit.labs.overthewire.org's password: 
Linux bandit 4.18.12 x86_64 GNU/Linux

[...]

Enjoy your stay!

WELCOME TO THE UPPERCASE SHELL
>> 
```
what is this?
```
WELCOME TO THE UPPERCASE SHELL
>> ls
sh: 1: LS: not found
>> whoami
sh: 1: WHOAMI: not found
>> exit
sh: 1: EXIT: not found
>>
```
it appears to switch every user input to uppercase... and Linux commands are all lowercase... how to break out of this shell? just with a command without letters...
```
>> $0
$ ls
uppershell
$ whoami
bandit33
$ pwd
/home/bandit32
$ cat /etc/bandit_pass/bandit33
c9c3199ddf4121b10cf581a98d51caee
$ exit
>>
```
back on the uppercase shell... Ctrl+c to terminate the connection.
```
>> ^CConnection to bandit.labs.overthewire.org closed.
bml@ubuntu:~/overthewire/bandit$
```

## Bandit Level 33 → Level 34

> **At this moment, level 34 does not exist yet.**

but you can connect to the server:
```
bandit33@bandit:~$ ls
README.txt
bandit33@bandit:~$ cat README.txt 
Congratulations on solving the last level of this game!

At this moment, there are no more levels to play in this game. However, we are constantly working
on new levels and will most likely expand this game with more levels soon.
Keep an eye out for an announcement on our usual communication channels!
In the meantime, you could play some of our other wargames.

If you have an idea for an awesome new level, please let us know!
```

## Final thoughts

It was a lot of fun to do this walkthrough, I've learned a lot, hope you did too!

Take care! FOLLOW YOUR DREAMS!!!